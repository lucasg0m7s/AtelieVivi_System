create database AtelieViviSystem;

create table Clientes(
	CPF char(11) Primary Key not null,
	RG char(9) not null Unique,
	Nome varchar(20) not null,
	Sobrenome varchar(20) not null,
	Celular char(11) not null Unique,
	User_Insta varchar(20) not null,
	Logradouro varchar(30) not null,
	Complemento varchar(20) not null,
	Rua varchar(50) not null,
	Bairro varchar(50) not null,
	Numero varchar(5) not null,
	Id_Cidade int not null
);

create table Cidades(
	Id_cidade int Primary Key not null,
	Cidade varchar(20) not null,
	Id_Estado int not null
);

create table Estados(
	Id_estado int Primary Key not null Identity(1,1),
	Estado char(2) not null,
);

create table Locacoes(
	Id_Locacao int Primary Key not null Identity(1,1),
	CPF_cliente char(11) not null,
	Data_Locacao date not null,
	Horario_Locacao time not null,
	Nome_Aniversariante varchar(20) not null,
	Sobrenome_Aniversariante varchar(20) not null,
	Tema varchar(20) not null,
	Logradouro varchar(30) not null,
	Complemento varchar(20) not null,
	Rua varchar(50) not null,
	Bairro varchar(50) not null,
	Numero varchar(5) not null,
	Id_Cidade int not null
);

alter table locacoes
add constraint FK_Cidades_Locacoes
Foreign Key (Id_Cidade)
References Cidades (Id_Cidade);

ALTER TABLE LOCACOES
ADD CONSTRAINT FK_CLIENTES_LOCACOES
FOREIGN KEY (CPF_CLIENTE)
REFERENCES CLIENTES (CPF)
ON DELETE CASCADE;

alter table clientes
add constraint FK_Cidades_Clientes
Foreign Key (Id_Cidade)
References Cidades (Id_Cidade);

alter table Cidades
add constraint FK_Estados_Cidades
Foreign Key (Id_Estado)
References Estados (Id_estado);

insert into Estados (Estado) values ('SP');
insert into Cidades (Id_cidade, Cidade, Id_Estado) values (1, 'Nova Odessa', 1), (2, 'Sumar√©', 1), (3, 'Americana', 1);